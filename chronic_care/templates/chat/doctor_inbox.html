{% extends 'base.html' %}
{% block content %}
<h3>Inbox</h3>
<form method="post" class="row g-2 align-items-end mb-3">
  {% csrf_token %}
  <div class="col-md-4">
    <label class="form-label">Patient</label>
    <select name="patient_id" class="form-select">
      {% for p in patients %}
        <option value="{{ p.id }}">{{ p.username }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="col-md-6">
    <label class="form-label">Reply</label>
    <input class="form-control" name="reply" placeholder="Type a message" />
  </div>
  <div class="col-md-2">
    <button class="btn btn-primary w-100" type="submit">Send</button>
  </div>
</form>
<table class="table table-sm table-striped">
  <thead><tr><th>From</th><th>To</th><th>Message</th><th>Time</th></tr></thead>
  <tbody>
  {% for m in messages_list %}
    <tr>
      <td>{{ m.sender.username }}</td>
      <td>{{ m.receiver.username }}</td>
      <td>{{ m.body }}</td>
      <td>{{ m.created_at|date:'Y-m-d H:i' }}</td>
    </tr>
  {% empty %}
    <tr><td colspan="4" class="text-center">No messages yet</td></tr>
  {% endfor %}
  </tbody>
</table>
{% endblock %}